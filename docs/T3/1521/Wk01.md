# Wk1

## Introductions

## Consider the following C program skeleton

```c
int  a;
char b[100];

int fun1() {
    int c, d;
    // ...
}

double e;

int fun2() {
    int f;
    static int ff;
    // ...
    fun1();
    // ...
}

unsigned int g;

int main(void) {
    char h[10];
    int i;
    // ...
    fun2();
    // ...
}
```

1. Which variables are accessible from within main()?
2. Which variables are accessible from within fun2()?
3. Which variables are accessible from within fun1()?
4. Which variables are deallocated when fun1() returns?
5. Which variables are deallocated when fun2() returns?
6. How long does the variable f exist during program execution?
7. How long does the variable g exist during program execution?

## Storage

What is the difference in the storage of below

```c
#include <stdio.h>

char *s1 = "abc";

int main(void) {
    char s2[] = "def";
    // ...
}
```

Have a look here!

<details>
<summary> 'Answer' </summary>

<iframe width="800px" height="200px" src="https://godbolt.org/e#g:!((g:!((g:!((h:codeEditor,i:(fontScale:14,j:1,lang:___c,selection:(endColumn:21,endLineNumber:6,positionColumn:21,positionLineNumber:6,selectionStartColumn:21,selectionStartLineNumber:6,startColumn:21,startLineNumber:6),source:'%23include+%3Cstdio.h%3E%0A%0Achar+*s1+%3D+%22abc%22%3B%0A%0Aint+main(void)+%7B%0A++++char+s2%5B%5D+%3D+%22def%22%3B%0A++++//+...%0A%7D'),l:'5',n:'0',o:'C+source+%231',t:'0')),k:50,l:'4',n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:cmips5el,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',libraryCode:'1',trim:'1'),fontScale:14,j:1,lang:___c,libs:!(),options:'',selection:(endColumn:51,endLineNumber:9,positionColumn:51,positionLineNumber:9,selectionStartColumn:43,selectionStartLineNumber:9,startColumn:43,startLineNumber:9),source:1),l:'5',n:'0',o:'MIPS+gcc+5.4+(el)+(Editor+%231,+Compiler+%231)+C',t:'0')),k:50,l:'4',n:'0',o:'',s:0,t:'0')),l:'2',n:'0',o:'',t:'0')),version:4"></iframe>

</details>

## Compiler Commands

For each of the following;

- `gcc -E x.c`
- `gcc -S x.c`
- `gcc -c x.c`
- `gcc x.c`

What do they produce for the following code;

```c
#include <stdio.h>
#define N 10

int main(void) {
  char str[N] = { 'H', 'i', '\0' };
  printf("%s\n", str);
  return 0;
}
```

<details>
<summary>Answer/Hint</summary>
<p>
  Look at below and change the compiler options (you don't need to add the `x.c`).  You may not notice a difference for `-c` and `-s`.
</p>

<iframe width="800px" height="200px" src="https://godbolt.org/e?hideEditorToolbars=true#g:!((g:!((g:!((h:codeEditor,i:(fontScale:14,j:1,lang:c%2B%2B,selection:(endColumn:18,endLineNumber:1,positionColumn:18,positionLineNumber:1,selectionStartColumn:18,selectionStartLineNumber:1,startColumn:18,startLineNumber:1),source:'%23include+%3Cstdio.h%3E%0A%23define+N+10%0A%0Aint+main(void)+%7B%0A++++char+str%5BN%5D+%3D+%7B+!'H!',+!'i!',+!'%5C0!'+%7D%3B%0A++++printf(%22%25s%5Cn%22,+str)%3B%0A++++return+0%3B%0A%7D'),l:'5',n:'0',o:'C%2B%2B+source+%231',t:'0')),k:28.318126885581506,l:'4',n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:mips564el,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',libraryCode:'1',trim:'1'),fontScale:14,j:1,lang:c%2B%2B,libs:!(),options:'-E',selection:(endColumn:1,endLineNumber:9,positionColumn:1,positionLineNumber:9,selectionStartColumn:1,selectionStartLineNumber:9,startColumn:1,startLineNumber:9),source:1),l:'5',n:'0',o:'MIPS64+gcc+5.4+(el)+(Editor+%231,+Compiler+%231)+C%2B%2B',t:'0')),header:(),k:35.80596978983636,l:'4',m:100,n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:mips564el,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',libraryCode:'1',trim:'1'),fontScale:14,j:3,lang:c%2B%2B,libs:!(),options:'',selection:(endColumn:1,endLineNumber:1,positionColumn:1,positionLineNumber:1,selectionStartColumn:1,selectionStartLineNumber:1,startColumn:1,startLineNumber:1),source:1),l:'5',n:'0',o:'MIPS64+gcc+5.4+(el)+(Editor+%231,+Compiler+%233)+C%2B%2B',t:'0')),header:(),k:35.87590332458213,l:'4',m:100,n:'0',o:'',s:0,t:'0')),l:'2',n:'0',o:'',t:'0')),version:4"></iframe>

</details>

## Do braces matter?

What does each of these print

```c
if (x == 0) {
    printf ("zero\n");
}
```

```c
if (x == 0)
    printf ("zero\n");
```

```c
if (x == 0) {
    printf ("zero\n");
    printf ("after\n");
}
```

```c
if (x == 0) {
    printf ("zero\n");
    printf ("after\n");
}
```

## Memory Address Recap

What does the following program print if you presume `n` is at address `0x7fff00000000`

```c
#include <stdio.h>

int main(void) {
    int n[4] = { 42, 23, 11, 7 };
    int *p;

    p = &n[0];
    printf("%p\n", p); // prints 0x7fff00000000
    printf("%lu\n", sizeof (int)); // prints 4

    // what do these statements print ?
    n[0]++;
    printf("%d\n", *p);
    p++;
    printf("%p\n", p);
    printf("%d\n", *p);

    return 0;
}
```

> You can assume sizeof(int) == 4

## Pointer Arithmetic

```c
int  x;  // a variable located at address 1000 with initial value 0
int *p;  // a variable located at address 2000 with initial value 0
```

Now perform each of the following operations noting the values of x, p after each one.

- `p = &x`
- `x = 5`
- `*p = 3`
- `x = (int)p`
- `x = (int)&p`
- `p = NULL`
- `*p = 1`

## GDB

> I'm gonna probably do something 'special' here if we get time :).

> GDB Recommended Content / Guide: https://www.cse.unsw.edu.au/~learn/debugging/modules/for_1521/
